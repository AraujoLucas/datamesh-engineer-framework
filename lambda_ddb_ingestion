import boto3
import json
import os
from datetime import datetime

dynamodb = boto3.resource('dynamodb')

def lambda_handler(event, context):

    print(f'evento de entrada aqui --> {event}')
    message = event['Records'][0]['Sns']['Message']
    # message = event['key']['Message']


    table = dynamodb.Table('ddb_ingestion')
    input_msg = json.loads(message)
    print("convert json to dict: ")
    
    print("dict_put: ")
    print(type(input_msg))
    print(input_msg)
    
    print("put item in ddbt: ")
    response = table.put_item(Item=input_msg)
    print("response put item: ")
    print(response['ResponseMetadata']['HTTPStatusCode'])

    return 0
    
